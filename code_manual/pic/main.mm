<map version="freeplane 1.11.5">
<!--To view this file, download free mind mapping software Freeplane from https://www.freeplane.org -->
<node TEXT="main()" FOLDED="false" ID="ID_696401721" CREATED="1610381621824" MODIFIED="1703567372269" STYLE="oval">
<font SIZE="18"/>
<hook NAME="MapStyle" zoom="1.001">
    <properties edgeColorConfiguration="#808080ff,#ff0000ff,#0000ffff,#00ff00ff,#ff00ffff,#00ffffff,#7c0000ff,#00007cff,#007c00ff,#7c007cff,#007c7cff,#7c7c00ff" show_icon_for_attributes="true" associatedTemplateLocation="template:/standard-1.6.mm" show_note_icons="true" fit_to_viewport="false"/>

<map_styles>
<stylenode LOCALIZED_TEXT="styles.root_node" STYLE="oval" UNIFORM_SHAPE="true" VGAP_QUANTITY="24 pt">
<font SIZE="24"/>
<stylenode LOCALIZED_TEXT="styles.predefined" POSITION="bottom_or_right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="default" ID="ID_271890427" ICON_SIZE="12 pt" COLOR="#000000" STYLE="fork">
<arrowlink SHAPE="CUBIC_CURVE" COLOR="#000000" WIDTH="2" TRANSPARENCY="200" DASH="" FONT_SIZE="9" FONT_FAMILY="SansSerif" DESTINATION="ID_271890427" STARTARROW="NONE" ENDARROW="DEFAULT"/>
<font NAME="SansSerif" SIZE="10" BOLD="false" ITALIC="false"/>
<richcontent TYPE="DETAILS" CONTENT-TYPE="plain/auto"/>
<richcontent TYPE="NOTE" CONTENT-TYPE="plain/auto"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.details"/>
<stylenode LOCALIZED_TEXT="defaultstyle.attributes">
<font SIZE="9"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.note" COLOR="#000000" BACKGROUND_COLOR="#ffffff" TEXT_ALIGN="LEFT"/>
<stylenode LOCALIZED_TEXT="defaultstyle.floating">
<edge STYLE="hide_edge"/>
<cloud COLOR="#f0f0f0" SHAPE="ROUND_RECT"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.selection" BACKGROUND_COLOR="#afd3f7" BORDER_COLOR_LIKE_EDGE="false" BORDER_COLOR="#afd3f7"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.user-defined" POSITION="bottom_or_right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="styles.topic" COLOR="#18898b" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subtopic" COLOR="#cc3300" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subsubtopic" COLOR="#669900">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.important" ID="ID_67550811">
<icon BUILTIN="yes"/>
<arrowlink COLOR="#003399" TRANSPARENCY="255" DESTINATION="ID_67550811"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.flower" COLOR="#ffffff" BACKGROUND_COLOR="#255aba" STYLE="oval" TEXT_ALIGN="CENTER" BORDER_WIDTH_LIKE_EDGE="false" BORDER_WIDTH="22 pt" BORDER_COLOR_LIKE_EDGE="false" BORDER_COLOR="#f9d71c" BORDER_DASH_LIKE_EDGE="false" BORDER_DASH="CLOSE_DOTS" MAX_WIDTH="6 cm" MIN_WIDTH="3 cm"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.AutomaticLayout" POSITION="bottom_or_right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="AutomaticLayout.level.root" COLOR="#000000" STYLE="oval" SHAPE_HORIZONTAL_MARGIN="10 pt" SHAPE_VERTICAL_MARGIN="10 pt">
<font SIZE="18"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,1" COLOR="#0033ff">
<font SIZE="16"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,2" COLOR="#00b439">
<font SIZE="14"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,3" COLOR="#990000">
<font SIZE="12"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,4" COLOR="#111111">
<font SIZE="10"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,5"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,6"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,7"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,8"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,9"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,10"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,11"/>
</stylenode>
</stylenode>
</map_styles>
</hook>
<hook NAME="AutomaticEdgeColor" COUNTER="7" RULE="ON_BRANCH_CREATION"/>
<node TEXT="BuildSupervisor()" LOCALIZED_STYLE_REF="default" POSITION="bottom_or_right" ID="ID_1523133597" CREATED="1703566469148" MODIFIED="1703581309801" HGAP_QUANTITY="-2.28571 pt" VSHIFT_QUANTITY="-1.28571 pt" STYLE="fork">
<edge STYLE="bezier" COLOR="#0000cc"/>
<node TEXT="NewSupervisor()" ID="ID_1453056625" CREATED="1703566560963" MODIFIED="1703576824120" VSHIFT_QUANTITY="15.85714 pt" STYLE="fork"/>
<node TEXT="SupervisorTxHandling()" ID="ID_156202857" CREATED="1703566576062" MODIFIED="1703662414149" HGAP_QUANTITY="13.57143 pt" VSHIFT_QUANTITY="-17.14286 pt" STYLE="fork">
<node TEXT="TxHandling()" ID="ID_150466775" CREATED="1703566648750" MODIFIED="1703567489792" COLOR="#990000" STYLE="fork" HGAP_QUANTITY="17.85714 pt" VSHIFT_QUANTITY="2.14286 pt">
<font STRIKETHROUGH="false" ITALIC="true"/>
<node TEXT="data2tx()" ID="ID_864601585" CREATED="1703567495216" MODIFIED="1703567525384" VSHIFT_QUANTITY="-2.14286 pt"/>
<node TEXT="txSending()" ID="ID_1521851243" CREATED="1703567519764" MODIFIED="1703582011322" VSHIFT_QUANTITY="3.42857 pt">
<arrowlink FONT_SIZE="6" DESTINATION="ID_1755343521" MIDDLE_LABEL="Transactions" STARTINCLINATION="176.57143 pt;0 pt;" ENDINCLINATION="-1.28571 pt;-24 pt;"/>
</node>
</node>
<node TEXT="CloseSupervisor()" ID="ID_184987752" CREATED="1703567265135" MODIFIED="1703576820025" HGAP_QUANTITY="17.85714 pt" VSHIFT_QUANTITY="-9 pt">
<node TEXT="StopAllNodes" ID="ID_960361916" CREATED="1703567288882" MODIFIED="1703661503096" HGAP_QUANTITY="3.71429 pt" VSHIFT_QUANTITY="6.85714 pt" STYLE="oval">
<edge COLOR="#000000"/>
</node>
</node>
</node>
<node TEXT="TcpListen()" ID="ID_786370190" CREATED="1703662407850" MODIFIED="1703662513154">
<node TEXT="handleClientRequest()" ID="ID_1095638200" CREATED="1703662501661" MODIFIED="1703662513153" VSHIFT_QUANTITY="11.14286 pt">
<node TEXT="handleBlockInfos()" ID="ID_712681595" CREATED="1703662530799" MODIFIED="1703662547242"/>
<node TEXT="HandleOtherMessage()" ID="ID_1300439359" CREATED="1703662582229" MODIFIED="1703662611251" COLOR="#990000">
<font ITALIC="true"/>
</node>
<node TEXT="HandleExtraMessage()" ID="ID_1587304867" CREATED="1703662589167" MODIFIED="1703662618434" COLOR="#990000">
<font ITALIC="true"/>
</node>
</node>
</node>
</node>
<node TEXT="BuildNewPbftNode()" POSITION="bottom_or_right" ID="ID_1307410335" CREATED="1703566484899" MODIFIED="1703576830144" HGAP_QUANTITY="9.71429 pt" VSHIFT_QUANTITY="25.71429 pt">
<edge COLOR="#ff00ff"/>
<node TEXT="NewPbftNode()" ID="ID_1156722310" CREATED="1703580705879" MODIFIED="1703680259112" HGAP_QUANTITY="10.14286 pt" VSHIFT_QUANTITY="0.42857 pt">
<node TEXT="NewBlockChain()" ID="ID_498459513" CREATED="1703680126378" MODIFIED="1703680228033" HGAP_QUANTITY="481.14287 pt">
<edge COLOR="#009999"/>
<node TEXT="NewGenisisBlock()" ID="ID_811762082" CREATED="1703680156151" MODIFIED="1703680160462"/>
</node>
</node>
<node TEXT="Propose()" ID="ID_446874899" CREATED="1703580809587" MODIFIED="1703943525407" HGAP_QUANTITY="22.14286 pt" VSHIFT_QUANTITY="11.57143 pt">
<arrowlink FONT_SIZE="6" DESTINATION="ID_70789957" MIDDLE_LABEL="Msg:PrePrepare" STARTINCLINATION="43.28572 pt;90.42857 pt;" ENDINCLINATION="-152.57143 pt;-17.57143 pt;"/>
<node TEXT="HandleinPropose()" ID="ID_1904157415" CREATED="1703581715132" MODIFIED="1703675516267" HGAP_QUANTITY="354.7143 pt" VSHIFT_QUANTITY="0.42857 pt" COLOR="#990000">
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
<node TEXT="GenerateBlock()" ID="ID_173131571" CREATED="1703675522402" MODIFIED="1703676032711" HGAP_QUANTITY="64.14286 pt" VSHIFT_QUANTITY="21.42857 pt">
<edge COLOR="#009999"/>
<node TEXT="PackTxs()" ID="ID_875104919" CREATED="1703675651191" MODIFIED="1703675876116" HGAP_QUANTITY="40.57143 pt" VSHIFT_QUANTITY="11.57143 pt"/>
<node TEXT="NewBlock()" ID="ID_1161059257" CREATED="1703675722075" MODIFIED="1703675879468" HGAP_QUANTITY="42.28572 pt" VSHIFT_QUANTITY="0.85714 pt"/>
<node TEXT="GetUpdateStatusTrie()" ID="ID_1956699102" CREATED="1703661732088" MODIFIED="1703676052862" HGAP_QUANTITY="205.14286 pt" VSHIFT_QUANTITY="-0.85714 pt">
<node TEXT="AccountState.Deposit()" ID="ID_385923111" CREATED="1703666284159" MODIFIED="1703666340043" VSHIFT_QUANTITY="-2.57143 pt">
<edge COLOR="#ff3333"/>
</node>
<node TEXT="AccountState.Deduct()" ID="ID_1504183760" CREATED="1703666322201" MODIFIED="1703666345751">
<edge COLOR="#ff3333"/>
</node>
<node TEXT="trie.Trie.Update()" ID="ID_1071547644" CREATED="1703663912082" MODIFIED="1703676057847" VSHIFT_QUANTITY="-0.85714 pt"/>
</node>
<node TEXT="GetTxTreeRoot()" ID="ID_1415921303" CREATED="1703661632517" MODIFIED="1703676048162" HGAP_QUANTITY="62.85714 pt" VSHIFT_QUANTITY="-1.28572 pt"/>
</node>
</node>
</node>
<node TEXT="TcpListen()" ID="ID_390656596" CREATED="1703580815561" MODIFIED="1703580828548" VSHIFT_QUANTITY="5.57143 pt">
<node TEXT="handleClientRequest()" ID="ID_1088448462" CREATED="1703580862525" MODIFIED="1703581074655" HGAP_QUANTITY="8 pt" VSHIFT_QUANTITY="19.71429 pt">
<node TEXT="handleMessage()" ID="ID_373568198" CREATED="1703580884097" MODIFIED="1703580922199" HGAP_QUANTITY="8.85714 pt" VSHIFT_QUANTITY="16.28571 pt">
<node TEXT="HandleMessageOutsidePBFT()" ID="ID_1663721067" CREATED="1703580968931" MODIFIED="1703581041982" COLOR="#990000" VSHIFT_QUANTITY="0.85714 pt">
<font ITALIC="true"/>
<node TEXT="handleInjectTx()" ID="ID_1755343521" CREATED="1703581107967" MODIFIED="1703581171117" VSHIFT_QUANTITY="-6.42857 pt">
<node TEXT="AddTxs2Pool()" ID="ID_885229490" CREATED="1703581219763" MODIFIED="1703943507685" HGAP_QUANTITY="46.57143 pt" VSHIFT_QUANTITY="21.42857 pt"/>
</node>
<node TEXT="handleRelay()" ID="ID_635204182" CREATED="1703581143963" MODIFIED="1703680234854" BORDER_DASH="DASHES"/>
</node>
<node TEXT="handlePrePrepare()" ID="ID_70789957" CREATED="1703580928343" MODIFIED="1703656473268" HGAP_QUANTITY="21.71429 pt" VSHIFT_QUANTITY="-21.42857 pt">
<arrowlink FONT_SIZE="6" DESTINATION="ID_1091072216" MIDDLE_LABEL="Msg:Prepare" STARTINCLINATION="1.28571 pt;6.42857 pt;" ENDINCLINATION="3 pt;-21 pt;"/>
<node TEXT="HandleinPrePrepare()" ID="ID_1356081384" CREATED="1703581917138" MODIFIED="1703667446522" HGAP_QUANTITY="39.28571 pt" COLOR="#990000">
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
<node TEXT="IsValidBlock()" ID="ID_1593471715" CREATED="1703661571892" MODIFIED="1703676038461" HGAP_QUANTITY="47 pt" VSHIFT_QUANTITY="-0.42857 pt">
<arrowlink SHAPE="EDGE_LIKE" DESTINATION="ID_1415921303"/>
<edge COLOR="#009999"/>
</node>
</node>
</node>
<node TEXT="handlePrepare()" ID="ID_1091072216" CREATED="1703580933903" MODIFIED="1703660226926" HGAP_QUANTITY="23 pt" VSHIFT_QUANTITY="-3.42857 pt">
<arrowlink FONT_SIZE="6" DESTINATION="ID_1361245614" MIDDLE_LABEL="Msg:Commit" STARTINCLINATION="3 pt;10.71429 pt;" ENDINCLINATION="0.42857 pt;-4.28571 pt;"/>
<node TEXT="HandleinPrepare()" ID="ID_1439578682" CREATED="1703581946116" MODIFIED="1703661468566" HGAP_QUANTITY="48.71429 pt" COLOR="#990000">
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
</node>
</node>
<node TEXT="handleCommit()" ID="ID_1361245614" CREATED="1703580939561" MODIFIED="1703660224353" HGAP_QUANTITY="23 pt" VSHIFT_QUANTITY="21 pt">
<arrowlink SHAPE="CUBIC_CURVE" DASH="3 3" FONT_SIZE="6" DESTINATION="ID_1121827307" MIDDLE_LABEL="Msg:RequestOldrequest" STARTINCLINATION="7.28571 pt;14.14286 pt;" ENDINCLINATION="0 pt;-13.71429 pt;"/>
<node TEXT="HandleinCommit()" ID="ID_272163856" CREATED="1703581948271" MODIFIED="1703675556191" HGAP_QUANTITY="51.28571 pt" COLOR="#990000">
<arrowlink FONT_SIZE="6" DESTINATION="ID_635204182" MIDDLE_LABEL="Msg:Relay" STARTINCLINATION="55.71429 pt;-19.71429 pt;" ENDINCLINATION="69 pt;8.57143 pt;"/>
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
<node TEXT="AddRelayTx()" ID="ID_1832972228" CREATED="1703661855691" MODIFIED="1704114306160" HGAP_QUANTITY="88.14286 pt" VSHIFT_QUANTITY="-0.42857 pt">
<edge COLOR="#009999"/>
</node>
<node TEXT="BlockChain.AddBlock()" ID="ID_1534823756" CREATED="1703661670941" MODIFIED="1703675789613" HGAP_QUANTITY="167.42857 pt" VSHIFT_QUANTITY="17.14286 pt">
<arrowlink SHAPE="EDGE_LIKE" DESTINATION="ID_1956699102"/>
<edge COLOR="#009999"/>
<node TEXT="storage.AddBlock()" ID="ID_124621714" CREATED="1703661785427" MODIFIED="1703663845586" HGAP_QUANTITY="15.28571 pt">
<node TEXT="bolt.DB.Update()" ID="ID_1152743623" CREATED="1703663806252" MODIFIED="1703663929494" HGAP_QUANTITY="26.42857 pt"/>
<node TEXT="storage.AddBlockHeader()" ID="ID_272388824" CREATED="1703663822380" MODIFIED="1703663930891" HGAP_QUANTITY="27.71429 pt"/>
<node TEXT="UpdateNewestBlock()" ID="ID_1273068549" CREATED="1703663846451" MODIFIED="1703663932277" HGAP_QUANTITY="28.14286 pt"/>
</node>
</node>
</node>
</node>
<node TEXT="handleRequestOldSeq()" ID="ID_1121827307" CREATED="1703580951805" MODIFIED="1703660212462" HGAP_QUANTITY="23.42857 pt" VSHIFT_QUANTITY="24 pt">
<arrowlink FONT_SIZE="6" DESTINATION="ID_618978128" MIDDLE_LABEL="Msg:SendOldMessage" STARTINCLINATION="1.71429 pt;8.57143 pt;" ENDINCLINATION="4.71429 pt;-5.57143 pt;"/>
<node TEXT="HandleReqestforOldSeq()" ID="ID_112830868" CREATED="1703660276487" MODIFIED="1703661479767" HGAP_QUANTITY="16.57143 pt" COLOR="#990000">
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
</node>
</node>
<node TEXT="handleSendOldSeq()" ID="ID_618978128" CREATED="1703580957004" MODIFIED="1703660222701" HGAP_QUANTITY="23.85714 pt" VSHIFT_QUANTITY="19.28571 pt">
<node TEXT="HandleforSequentialRequest()" ID="ID_1847730118" CREATED="1703660303021" MODIFIED="1703675566763" HGAP_QUANTITY="31.14286 pt" COLOR="#990000">
<arrowlink SHAPE="EDGE_LIKE" DESTINATION="ID_1534823756" STARTARROW="NONE" ENDARROW="NONE"/>
<font ITALIC="true"/>
<edge COLOR="#00ff00"/>
</node>
</node>
<node TEXT="WaitToStop()" ID="ID_673916033" CREATED="1703580963576" MODIFIED="1703658774644" VSHIFT_QUANTITY="6.85714 pt">
<node TEXT="StopNode" ID="ID_1150987725" CREATED="1703661507173" MODIFIED="1703661534215" STYLE="oval" HGAP_QUANTITY="23 pt" VSHIFT_QUANTITY="7.28571 pt">
<edge COLOR="#000000" DASH="SOLID"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</map>
